% This is kcp.sty
% version: 2002/09/17
% author: Guido Governatori
%         guido@itee.uq.edu.au
%
%switches
%
\newif\ifmonograph
% theorem with section number
\newtheorem{theorem}{\rm THEOREM}[chapter]
\newtheorem{Bexample}[chapter]{\rm EXAMPLE}
\newtheorem{uctexample}[theorem]{\rm EXAMPLE}
\newtheorem{elaboration}[theorem]{\rm ELABORATION}
\newtheorem{observation}[theorem]{\rm OBSERVATION}
\newtheorem{digression}[theorem]{\rm DIGRESSION}
\newtheorem{remarks}[theorem]{\rm REMARKS}
\newtheorem{examples and remarks}[theorem]{\rm EXAMPLES and REMARKS}
\newtheorem{facts}[theorem]{\rm FACTS}
\newtheorem{lemma}[theorem]{\rm LEMMA}
\newtheorem{problem}[theorem]{\rm PROBLEM}
\newtheorem{corollary}[theorem]{\rm COROLLARY}
\newtheorem{proposition}[theorem]{\rm PROPOSITION}
\newtheorem{summary}[theorem]{\rm SUMMARY}
\newtheorem{definition}[theorem]{\rm DEFINITION}
\newtheorem{property}[theorem]{\rm PROPERTY}
\newtheorem{remark}[theorem]{\rm REMARK}
\newtheorem{notation}[theorem]{\rm NOTATION}
%\newtheorem{axiom}[theorem]{\rm AXIOM}
\newtheorem{fact}[theorem]{\rm FACT}
\newtheorem{exercise}[theorem]{\rm EXERCISE}
\newtheorem{example}[theorem]{\rm EXAMPLE}
\newtheorem{examples}[theorem]{\rm EXAMPLES}
\newtheorem{postulate}[theorem]{\rm POSTULATE}
\newtheorem{proposal}[theorem]{\rm PROPOSAL}
\newtheorem{assumption}[theorem]{\rm ASSUMPTION}
\newtheorem{conjecture}[theorem]{\rm CONJECTURE}
\newtheorem{result}[theorem]{\rm RESULT}%
\newtheorem{scenario}[theorem]{\rm SCENARIO}%
\newtheorem{case}[theorem]{\rm CASE}%
\newtheorem{convention}[theorem]{\rm CONVENTION}%
%%\newtheorem{result}[theorem]{\rm RESULT}%
%%\newenvironment{example}{\begin{Example}\rm}%
%%{\end{Example}}


\newtheorem{remarknonumber}{\rm REMARK}
\newtheorem{nonumbers}{Nonumbers}
\newtheorem{exdef}[nonumbers]{\sc Definition}
\newtheorem{exrem}[nonumbers]{\sc Remark}
\newtheorem{exque}[nonumbers]{\sc Question}
\newtheorem{exex}[nonumbers]{\sc Example}
\newtheorem{exlem}[nonumbers]{\sc Lemma}
\newtheorem{assertion}[nonumbers]{\sc Assertion}



%% from OUP's style
%% from here ...


\def\setthmfont{%
        \def\theoremtest{theorem}
        \def\proptest{proposition}
        \def\lemmatest{lemma}
        \def\coroltest{corollary}
        \ifx\@currenvir\theoremtest     \def\@thmfont{\it}\else
        \ifx\@currenvir\proptest        \def\@thmfont{\it}\else
        \ifx\@currenvir\lemmatest       \def\@thmfont{\it}\else
        \ifx\@currenvir\coroltest       \def\@thmfont{\it}\else
        \def\@thmfont{\rm}\fi\fi\fi\fi
        }
\def\@begintheorem#1#2{%
        \setthmfont
        \par\addvspace{4pt}\noindent
        {\bf #1\ #2.}\ignorespaces
        \hskip 0.5pc\@thmfont}
\def\@opargbegintheorem#1#2#3{%
        \setthmfont
        \par\addvspace{4pt}\noindent
        {\bf #1\ #2\ (#3).}\ignorespaces
        \hskip 0.5pc\@thmfont}
\def\@endtheorem{\rm\vskip 4pt}
%%
%%% to here
\newcommand{\citedef}[1]{\ \hspace{-1pt}{\rm \cite{#1}}}



\newif\ifThmWithSection
\def\TheoremWithSection{\ThmWithSectiontrue}
\def\TheoremWithoutSection{\ThmWithSectionfalse}


\def\Thm{\ifThmWithSection
   \ifmonograph
   \def\thetheorem{\theCchapter.\arabic{theorem}}
   \else
   \@addtoreset{theorem}{section}
   \def\thetheorem{\thesection.\arabic{theorem}}
   \fi
\else
\def\thetheorem{\arabic{theorem}}
\fi}


\newenvironment{proof}{\begin{trivlist}\item[]{\bf Proof.}}{\hspace*{\fill}
$\blacksquare$ \end{trivlist}}
\newenvironment{proofof}{\begin{trivlist}\item[]{\bf Proof~}}{\hspace*{\fill}
$\blacksquare$ \end{trivlist}}
\newenvironment{sketch}{\begin{trivlist}\item[]{\bf Sketch of the proof}}{\hspace*{\fill}
$\blacksquare$ \end{trivlist}}



\def\Monograph{\pagestyle{monograph}\monographtrue}
\def\Collection{\pagestyle{headings}\monographfalse
 \def\thepart{\Roman{part}}
 \def\theequation{\arabic{equation}}
 \def\thefigure{\arabic{figure}}
 \def\thetable{\arabic{table}}
 \setcounter{tocdepth}{0}}
\def\monograph{\Monograph\TheoremWithSection\Thm}
\def\collection{\Collection\TheoremWithoutSection\Thm}
\def\handbook{\Collection\TheoremWithSection\Thm}
%
%lengths
%
%\newcommand{\otto}{\fontsize{8}{9}\selectfont}
\newcommand{\otto}{\@setsize\otto{9pt}\viiipt\@viiipt}
\setlength{\textheight}{175mm}
%% guido set it to 11 x 16.5 cm
%% I don't know why! I reset it to 185 (as recommended by Kluwer)
%% but this yields a total height of 195 with header.
%% changed from 185 24.6.97
%% this will make it match Mackie's book exactly.
\setlength{\textwidth}{115mm} \setlength{\oddsidemargin}{2.21cm}
\setlength{\evensidemargin}{2.21cm}
\parindent=4mm
\addtolength{\headheight}{2pt}
%
%1998/05/14--->
%
%Thanks
%and
%MakeTextUppercase from textcase by David Carlise
%
\def\@uclcnotmath#1#2#3#4{\begingroup #1%
      \def\({$}\let\)\(%
      \def\NoCaseChange##1{\noexpand\NoCaseChange{\noexpand##1}}%
      \@nonchangecase\label
      \@nonchangecase\ref
      \@nonchangecase\ensuremath
      \@nonchangecase\thanks
      \def\cite##1##{\toks@{\noexpand\cite##1}\@citex}%
      \def\@citex##1{\NoCaseChange{\the\toks@{##1}}}%
      \def\reserved@a##1##2{\let#2\reserved@a}%
      \expandafter\reserved@a\@uclclist\reserved@b{\reserved@b\@gobble}%
      \protected@edef\reserved@a{\endgroup%
          \noexpand\@skipmath#3#4$\valign$}%
      \reserved@a}
\def\@nonchangecase#1{\def#1##1{\NoCaseChange{#1{##1}}}}
\let\NoCaseChange\@firstofone
\def\@skipmath#1#2$#3${%
  \@skip@nonchangecase#1#2\NoCaseChange\valign%
  \ifx\valign#3%
  \else
    $#3$%
    \expandafter\@skipmath\expandafter#1%
  \fi}
\def\@skip@nonchangecase#1#2\NoCaseChange#3{%
  #1{#2}%
  \ifx\valign#3%
  \else
    #3%
    \expandafter\@skip@nonchangecase\expandafter#1%
  \fi}
\DeclareRobustCommand\MakeTextUppercase{%
  \@uclcnotmath{\def\i{I}\def\j{J}}{##1##2}\uppercase}
\DeclareRobustCommand\MakeTextLowercase{%
  \@uclcnotmath{}{##2##1}\lowercase}
%$ Just to make emacs happy
\newif\ifTitle
\renewcommand{\thanks}[1]{\ifTitle\protect\footnote{\NoCaseChange{#1}}
  \else\null\fi}
%<---1998/05/14
%
%title
%
\def\author#1{\gdef\@autore{\otto #1}
     \gdef\@autoret{\textsc{\large\protect\Titletrue #1}}
     \gdef\Author{\protect\Titlefalse #1}}
    \def\@autore{}
    \def\@autoret{}
\def\title#1{\gdef\@titolo{\textbf{\LARGE\protect\Titletrue #1}}
     \gdef\@shtitle{\otto #1}
     \gdef\Title{\protect\Titlefalse#1}}
    \def\@titolo{}
    \def\@shtitle{}
    \def\shortitle#1{\gdef\@shtitle{\otto #1}}
\renewcommand{\maketitle}{%
\renewcommand{\thefootnote}{\arabic{footnote}}%%%%% Anna{\fnsymbol{footnote}}
\refstepcounter{chapter}
%\addtocounter{chapter}{-1}
\thispagestyle{copy}%%
\begingroup
\parindent 0pt
%%%%%
%% for the chapter number un/comment the next lines
%%%%%
%% js \textbf{\Large \thechapter} \vspace{-6pt}\par
 \hrulefill \linebreak \null \vspace{-8pt}\par
\@titolo \vspace{6pt} \par \large\textsc{\@autoret}\par \nobreak
 \hrulefill \linebreak \null \vspace{-8pt}\par
\vspace*{36pt}
%%-->copyright part
\refstepcounter{paper}%
\label{\thepaper-fp}%
%%<--
\renewcommand{\thefootnote}{\arabic{footnote}}
\setcounter{footnote}{0}
\endgroup
}
%
%paper
%
\def\@paper[#1]#2#3{\clearemptydoublepage
   \title{#2}\shortitle{#1}\author{#3}\maketitle
   \addcontentsline{toc}{Chapter}%
%    {\protect{\mbox{\uppercase{#3}}\vskip1pt{#2}}}}
    {\protect{\mbox{\MakeTextUppercase{#3}}\protect\\ {#2}}}}
\def\@@paper#1#2{\clearemptydoublepage
    \title{#1}\author{#2}\maketitle
    \addcontentsline{toc}{Chapter}%
%   {\protect{\protect\parbox{10cm}{\uppercase{#2}\\ {#1}}}}
%   {\protect{\vbox{\mbox{\uppercase{#2}}\vskip1pt\mbox{#1}}}}
    {\protect{\MakeTextUppercase{#2}\protect\\ {#1}}}}
\def\paper{\main\@ifnextchar[{\@paper}{\@@paper}}


\def\l@Chapter#1#2{\addpenalty{-\@highpenalty}%
   \vskip 1em plus 1pt minus 1pt
   \@tempdima 0em
   \begingroup
     \parindent \z@ \rightskip \@pnumwidth
     \parfillskip -\@pnumwidth
     \leavevmode
      \advance\leftskip\@tempdima
      \hskip -\leftskip
\parbox[b]{\textwidth}{#1\nobreak\hfill \nobreak\hbox
to\@pnumwidth{\hss #2}}\par \penalty\@highpenalty
   \endgroup}
%
%quotation and abstract
%
\renewenvironment{quotation}{\begin{list}{}{\leftmargin=10pt%
\rightmargin=10pt%
\listparindent=0pt}\item[]\otto}%
{\end{list}}
\newenvironment{abstract}{\begin{list}{}{\listparindent 1.5em
    \itemindent\listparindent
    \rightmargin\leftmargin \parsep \z@ plus\p@}
    \item[]\noindent{\sc abstract.~}\small}%
{\end{list}}
%
% running heads
%
\newif\ifCopyRight
\newcounter{paper}
\newcommand{\CopyrightContent}{}
\newcommand{\Copyright}[1]{\CopyRighttrue
  \gdef\CopyrightContent{\parbox[t]{\textwidth}{#1}}}
\newcommand{\PaperFirstPage}{\pageref{\thepaper-fp}}
\newcommand{\PaperLastPage}{\pageref{\thepaper-lp}}
\newcommand{\EndPaper}{\label{\thepaper-lp}}


\def\frontmatter{\clearemptydoublepage\pagenumbering{roman}}
\def\mainmatter{}%\clearemptydoublepage\pagenumbering{arabic}
    %\setcounter{page}{1} %% just for TAbleaux handbook}
\def\ps@headings{%
      \let\@oddfoot\@empty\let\@evenfoot\@empty
      \def\@evenhead{\otto\thepage\hfil\@autore\hfil}%
      \def\@oddhead{\otto\hfil\@shtitle\hfil\thepage}}
\def\ps@title{%
      \let\@oddfoot\@empty\let\@evenfoot\@empty%
      \def\@evenhead{\hfil\@autoret\hfil}%
      \def\@oddhead{\begin{minipage}[t]{\textwidth}%
        \begin{center}\@autoret\end{center}\end{minipage}}}
\def\ps@copy{%
      \def\@oddfoot{\CopyrightContent}%
      \def\@evenfoot{\CopyrightContent}%
      \let\@evenhead\@empty\let\@oddhead\@empty}
\def\ps@monograph{%
      \let\@oddfoot\@empty\let\@evenfoot\@empty
      \def\@evenhead{\otto\thepage\hfil\@shtitle\hfil}%
      \def\@oddhead{\otto\hfil\chaptermark\hfil\thepage}}
\def\shortchapter{\@ifstar{\Chmark}{\chmark}}
\def\Chmark#1{\gdef\chaptermark{\MakeTextUppercase{#1}}}
\def\chmark#1{\gdef\chaptermark{\thechapter.~\MakeTextUppercase{#1}}}
%
\def\chaptername{CHAPTER}
\newcommand{\ChapterMarkFormat}[1]{\gdef\@CMF{#1}}
\newcommand{\righthead}[1]{\ifmonograph \def\chaptermark{#1}
  \else \def\@shtitle{#1}\fi}
\newcommand{\lefthead}[1]{\ifmonograph \def\@shtitle{#1}
  \else \def\@autore{#1}\fi}
%
%sectioning
%
\newcommand{\clearemptydoublepage}{\newpage{\pagestyle{empty}\cleardoublepage}}
%1996/06/13
\renewcommand{\part}[1]{
\clearemptydoublepage \thispagestyle{empty}
    \refstepcounter{part}%
    \addcontentsline{toc}{part}%
       {PART~\thepart\quad\MakeTextUppercase{#1}}
    \vskip\baselineskip
    \begin{center}
    \large PART~\thepart
    \vskip2\baselineskip
        \Large\MakeTextUppercase{#1}
    \vskip2\baselineskip
    \end{center}
    \newpage
        \thispagestyle{empty} %% added by jane
    \def\chaptermark{\MakeTextUppercase{#1}}
\@afterindentfalse }
%
\newcommand{\cHapter}[1]{%
\clearemptydoublepage \thispagestyle{plain}
    \refstepcounter{chapter}%
    \addcontentsline{toc}{chapter}{%
       \MakeTextUppercase{\chaptername}~\thechapter\quad\MakeTextUppercase{#1}}
    \vskip\baselineskip
    \begin{center}
    \large\MakeTextUppercase{\chaptername}~\thechapter
    \vskip2\baselineskip
        \Large\MakeTextUppercase{#1}
    \end{center}
    \vskip3\baselineskip
    \def\chaptermark{\@CMF~\MakeTextUppercase{#1}}
\@afterindentfalse }
\newcommand{\Chapter}[1]{%
\clearemptydoublepage
  \thispagestyle{plain}
\refstepcounter{chapter} \addtocounter{chapter}{-1}
    \addcontentsline{toc}{chapter}{\MakeTextUppercase{#1}}%
    \vspace*{1em}
    \begin{center}
        \Large\MakeTextUppercase{#1}
    \end{center}
    \vskip3\baselineskip
    \def\chaptermark{\MakeTextUppercase{#1}}
\@afterindentfalse%
}
\def\chapter{\@ifstar{\Chapter}{\cHapter}}
\def\section{\@startsection {section}{1}{\z@}
    {-2ex plus -.5ex minus -.2ex}{.8ex plus .08ex}{\raggedright\large\bf}}
\def\subsection{\@startsection{subsection}{2}{\z@}
    {-1.5ex plus -.25ex minus -.1ex}{.6ex plus .06ex}{\raggedright\normalsize\bf}}
\def\subsubsection{\@startsection{subsubsection}{3}{\z@}
    {-1ex plus -.15ex minus -.06ex}{.4ex plus .04ex}{\raggedright\normalsize\bf}}
\def\paragraph{\@startsection{paragraph}{4}{\z@}
    {.5ex plus .05ex minus .025ex}{-.66em}{\normalsize\bf}}
\def\subparagraph{\@startsection{subparagraph}{5}{\parindent}
    {.25ex plus .01ex minus .005ex}{-.66em}{\normalsize\it}}


\def\thesection{\arabic{section}}
%
%Appendices
%
\newif\ifappendixch
\newif\ifappendixSec
\appendixchfalse
\appendixSecfalse
\newcounter{LastCh}
\newcounter{LastSec}[chapter]
\newcounter{Cchapter}
\def\theCchapter{\thechapter}
\let\chptr\chapter
\renewcommand{\appendix}{\par
\appendixSectrue
\def\chapter{\appendixchtrue\def\theCchapter{\thechapter}\chptr}
\def\chaptername{\MakeTextUppercase{Appendix}}
\setcounter{LastCh}{\thechapter} \setcounter{LastSec}{\thesection}
\def\theCchapter{\theLastCh}
\setcounter{chapter}{0} \setcounter{section}{0}
\renewcommand\thechapter{\@Roman\c@chapter}
\renewcommand\thesection{\ifappendixch\thechapter.\fi\@Alph\c@section}
}
%
\newcommand{\Appendix}{\@ifstar{\dices}{\dix}}
\newcommand{\dix}{\appendix\section*{Appendix}}
\newcommand{\dices}{\appendix\section*{Appendices}}
%
%main restores normal behaviors after \appendix and \appendix*;
%\paper executes automatically \main
%
\newcommand{\main}{\appendixchfalse
\appendixSecfalse\par
\setcounter{chapter}{\theLastCh} \setcounter{section}{\theLastSec}
\renewcommand\thechapter{\arabic{chapter}}
\renewcommand\thesection{\arabic{section}}
\renewcommand{\chaptername}{\MakeTextUppercase{Chapter}}
\let\chapter\chptr
}
%
%equation
%
\def\equation{\@ifnextchar [{\Nome}{\Number}}%


\def\endequation{$\rm\end{list}}


% for Linz  \newenvironment{equation*}%
% for Linz  {\begin{list}{}%
% for Linz  {\setlength{\labelwidth}{6mm}%
% for Linz  \setlength{\leftmargin}{8mm}%
% for Linz  \setlength{\labelsep}{2mm}}
% for Linz  \item $\displaystyle %}
% for Linz  {$\rm\end{list}} }


\def\Number{\refstepcounter{equation}\begin{list}{(\theequation)\hfill}%
{\setlength{\labelwidth}{6mm}%
\setlength{\leftmargin}{8mm}%
\setlength{\labelsep}{2mm}}
\item $\displaystyle}


\def\Nome[#1]{\begin{list}{#1\hfill}%
{\setlength{\labelwidth}{6mm}%
\setlength{\leftmargin}{8mm}%
\setlength{\labelsep}{2mm}}
\item $\displaystyle}
%
\let\Equation\equation
\let\endEquation\endequation
%% for Matthews \newenvironment{Equation*}%
%% for Matthews {\begin{list}{}%
%% for Matthews {\setlength{\labelwidth}{6mm}%
%% for Matthews \setlength{\leftmargin}{8mm}%
%% for Matthews \setlength{\labelsep}{2mm}}
%% for Matthews \item $\displaystyle}
%% for Matthews {$\rm\end{list}}%
%
%MULTILINES COMMANDS
%
\def\leqline#1{$\\ $\displaystyle #1}
\def\reqline#1{$\\ \hspace*{\fill}$\displaystyle #1}
\def\ceqline#1{$\\ \hspace*{\fill}$\displaystyle #1$\hspace*{\fill}${}}
%
% contents
%
\def\@Contentsname{\uppercase\expandafter{\contentsname}}
\renewcommand{\tableofcontents}{%
\clearemptydoublepage \thispagestyle{empty} \vspace*{1em}
\begin{center}
\Large\@Contentsname
\end{center}
\vskip3\baselineskip \@starttoc{toc} \markright{\@Contentsname}}
\newcommand{\Firstpage}{\tableofcontents}


%
% list of figures
%
\def\@ListOfFigName{\uppercase\expandafter{List of Figures}}
\renewcommand{\listoffigures}{%
\chapter*{\@ListOfFigName}
\@starttoc{lof} \markright{\@ListOfFigName}}
%
% list of figures
%
\def\@ListOfTablesName{\uppercase\expandafter{List of Figures}}
\renewcommand{\listoftables}{%
\chapter*{\@ListOfTablesName}
\@starttoc{lot} \markright{\@ListOfTablesName}}
%
\def\l@chapter#1#2{\addpenalty{-\@highpenalty}%
   \vskip 1.0em plus\p@
   \@tempdima 1.5em
   \begingroup
     \parindent \z@ \rightskip \@pnumwidth
     \parfillskip -\@pnumwidth
     \leavevmode
%      \advance\leftskip\@tempdima
%      \hskip -\leftskip
     #1\nobreak\hfil \nobreak\hbox to\@pnumwidth{\hss #2}\par
     \penalty\@highpenalty
   \endgroup}
%
% References/Bibliography
%
\def\bibname{\ifmonograph%
              Bibliography
             \else
              Bibliography \fi} %%js was References
\def\@bibname{\uppercase\expandafter{\bibname}}
\renewenvironment{thebibliography}[1]
     {\ifmonograph
\newpage \vspace*{.7cm}\begin{center}{\large{\@bibname}}\end{center}\vspace{1cm}\thispagestyle{empty}
       %\chapter*{\@bibname}
\gdef\chaptermark{\@bibname}
        \else
         \section*{\@bibname}
         \otto
        \fi
     \list{\@biblabel{\@arabic\c@enumiv}}%
           {\settowidth\labelwidth{\@biblabel{#1}}%
            \leftmargin\parindent
            \parsep 0pt plus 1pt
            \itemsep 0pt plus 1pt
            \usecounter{enumiv}%
            \let\p@enumiv\@empty
           \renewcommand\theenumiv{\@arabic\c@enumiv}}%
       \renewcommand\newblock{\hskip .11em \@plus.33em \@minus.07em}%
      \sloppy\clubpenalty4000\widowpenalty4000%
     \sfcode`\.=\@m}
    {\def\@noitemerr
      {\@latex@warning{Empty `thebibliography' environment}}%
     \endlist}
%
% Index
%
\renewenvironment{theindex}{\clearemptydoublepage
                \thispagestyle{empty}
                \if@twocolumn
                  \@restonecolfalse
                \else
                  \@restonecoltrue
                \fi
                \columnseprule .2mm
                \columnsep 35\p@
                \twocolumn[\vspace*{1em}
    \begin{center}
        \Large\MakeTextUppercase{Index}
    \end{center}
    \vskip3\baselineskip]%
    \addcontentsline{toc}{chapter}{INDEX}%
    \def\chaptermark{\MakeTextUppercase{Index}}
    \def\@autore{\MakeTextUppercase{Index}}
    \def\@shtitle{\MakeTextUppercase{Index}}
                \parindent\z@
                \parskip\z@ \@plus .3\p@\relax
                \let\item\@idxitem}
               {\if@restonecol\onecolumn\else\clearpage\fi}
%
%caption
%
\long\def\@makecaption#1#2{%
   \vskip 10\p@
   \setbox\@tempboxa\hbox{#1. #2}%
   \ifdim \wd\@tempboxa >\hsize
       #1. #2\par
     \else
       \hbox to\hsize{\hfil\box\@tempboxa\hfil}%
   \fi}
%
\def\@CMF{\thechapter.}
\endinput
%%
%% END OF FILE
%%


\def\@oddsidemargin{12.1cm}
\def\@evensidemargin{12.2cm}
